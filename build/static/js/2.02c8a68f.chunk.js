"use strict";(self.webpackChunkntask=self.webpackChunkntask||[]).push([[2],{2:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var i=t(3433),o=t(1413),s=t(9439),r=t(6599),l=t(421),c=t(2791),a=t(9712),u=t(7552),x=t(824),d=t(5777),f=t(9434),h=t(4771),m=t(1363),g=t(2506),p=t(1346),j=t(3174),v=t(184);function y(){var e=(0,f.I0)(),n=(0,f.v9)((function(e){return e.auth.userData})),t=(0,f.v9)((function(e){return e.chat.events})),y=(0,f.v9)((function(e){return e.chat.msgList})),b=(0,c.useState)(null),C=(0,s.Z)(b,2),S=C[0],D=C[1],Z=(0,c.useState)({from:null}),k=(0,s.Z)(Z,2),w=k[0],E=k[1],I=(0,c.useState)([]),z=(0,s.Z)(I,2),L=z[0],M=z[1],R=(0,c.useState)(null),A=(0,s.Z)(R,2),G=A[0],H=A[1],J=(0,c.useState)(null),N=(0,s.Z)(J,2),O=N[0],P=N[1],V=(0,c.useRef)({});(0,c.useEffect)((function(){e((0,j.PL)({page:0,size:30}));var n=new g("http://34.172.124.66:8080/ws"),t=(0,p.over)(n);t.connect({},(function(e){console.log("Connected: ".concat(e))}),(function(e){console.log(e)})),H(t)}),[]),(0,c.useEffect)((function(){n&&null!==n.id&&void 0!==n.id&&E((0,o.Z)((0,o.Z)({},w),{},{from:n.id}))}),[n]),(0,c.useEffect)((function(){if(S){e((0,j.mz)({eventID:S.id,page:0,size:30})),O&&O.unsubscribe();var n=G.subscribe("/topic/".concat(S.id),(function(e){console.log(e),M((function(n){return[JSON.parse(e.body)].concat((0,i.Z)(n))}))}));P(n)}}),[S]),(0,c.useEffect)((function(){y&&M(y)}),[y]);return(0,v.jsxs)(a.xu,{as:"div",sx:{display:"flex",flexDirection:"row",p:2,width:"100%",height:"100%",gap:"0.5rem",boxShadow:"md"},children:[(0,v.jsx)(a.xu,{sx:{display:"flex",flex:4,flexDirection:"column",borderRight:"1px solid",borderColor:"gray.200"},children:(0,v.jsxs)(a.xu,{as:"div",sx:{display:"flex",flexDirection:"column"},children:[S?(0,v.jsx)(a.aV,{sx:{m:2},children:(0,v.jsx)(h.Z,{dataLength:L.length,next:function(){console.log("load more message")},height:"500px",style:{display:"flex",flexDirection:"column-reverse",gap:"0.2rem",m:2},hasMore:!0,loader:(0,v.jsx)(u.Ex,{isIndeterminate:!0}),children:L.length<0?(0,v.jsx)(a.HC,{children:(0,v.jsx)(a.xv,{children:"Let\u2018s start chatting"})},"no-content"):L.map((function(e){return(0,v.jsx)(a.HC,{children:(0,v.jsx)(a.xu,{sx:{display:"flex",justifyContent:e.from===n.id?"end":"start"},children:(0,v.jsx)(a.xv,{sx:{width:"max-content",padding:".2rem .5rem",color:"blackAlpha.900",backgroundColor:"gray.300",borderRadius:"0.3rem"},children:e.content})})},"message_".concat(e.id))}))})}):(0,v.jsx)(a.xu,{component:"div",height:"500px",display:"flex",flexDirection:"column",justifyContent:"end",children:(0,v.jsx)(a.xv,{textAlign:"center",children:"Please choose a room"})}),(0,v.jsxs)(a.xu,{as:"form",sx:{display:"flex",gap:"0.2rem",m:2},onSubmit:function(e){e.preventDefault();var t=V.current,i=t.value.trim();if(""!==i){var o={content:i,room:S.id,from:n.id};G.send("/app/chat.sendMessage",{},JSON.stringify(o)),t.value=""}},children:[(0,v.jsx)(x.II,{sx:{flex:11},ref:V}),(0,v.jsx)(d.zx,{type:"submit",colorScheme:"messenger",children:(0,v.jsx)(m.G,{icon:l.XC})})]})]})}),(0,v.jsx)(a.xu,{sx:{display:"flex",flex:1,flexDirection:"column"},children:(0,v.jsx)(h.Z,{dataLength:t.length,next:function(){console.log("load more room")},height:"100%",style:{display:"flex",flexDirection:"column",gap:"0.2rem"},hasMore:!0,loader:(0,v.jsx)(u.Ex,{isIndeterminate:!0}),children:t.map((function(e){return(0,v.jsxs)(d.zx,{variant:"solid",colorScheme:S&&S.id===e.id?"teal":"gray",onClick:function(){D(e)},children:[(0,v.jsx)(m.G,{icon:r.FV}),"\xa0",e.name]},e.id)}))})})]})}}}]);
//# sourceMappingURL=2.02c8a68f.chunk.js.map