"use strict";(self.webpackChunkntask=self.webpackChunkntask||[]).push([[2],{2:function(e,n,t){t.r(n),t.d(n,{default:function(){return y}});var i=t(3433),s=t(1413),o=t(9439),r=t(6599),c=t(421),l=t(2791),a=t(9712),x=t(7552),d=t(824),u=t(5777),f=t(9434),h=t(4771),m=t(1363),p=t(2506),g=t(1346),j=t(3174),v=t(184);function y(){var e=(0,f.I0)(),n=(0,f.v9)((function(e){return e.auth.userData})),t=(0,f.v9)((function(e){return e.chat.events})),y=(0,f.v9)((function(e){return e.chat.msgList})),b=(0,l.useState)(null),C=(0,o.Z)(b,2),D=C[0],S=C[1],k=(0,l.useState)({from:null}),Z=(0,o.Z)(k,2),w=Z[0],E=Z[1],I=(0,l.useState)([]),z=(0,o.Z)(I,2),L=z[0],M=z[1],R=(0,l.useState)(null),A=(0,o.Z)(R,2),G=A[0],H=A[1],J=(0,l.useRef)({});(0,l.useEffect)((function(){e((0,j.PL)({page:0,size:30}));var n=new p("http://34.172.124.66:8080/ws"),t=(0,g.over)(n);t.connect({},(function(e){console.log("Connected: ".concat(e))})),H(t)}),[]),(0,l.useEffect)((function(){n&&null!==n.id&&void 0!==n.id&&E((0,s.Z)((0,s.Z)({},w),{},{from:n.id}))}),[n]),(0,l.useEffect)((function(){D&&(e((0,j.mz)({eventID:D.id,page:0,size:30})),G.subscribe("/topic/".concat(D.id),(function(e){M((function(n){return[JSON.parse(e.body)].concat((0,i.Z)(n))}))})))}),[D]),(0,l.useEffect)((function(){y&&M(y)}),[y]);return(0,v.jsxs)(a.xu,{as:"div",sx:{display:"flex",flexDirection:"row",p:2,width:"100%",height:"100%",gap:"0.5rem",boxShadow:"md"},children:[(0,v.jsx)(a.xu,{sx:{display:"flex",flex:4,flexDirection:"column",borderRight:"1px solid",borderColor:"gray.200"},children:(0,v.jsxs)(a.xu,{as:"div",sx:{display:"flex",flexDirection:"column"},children:[D?(0,v.jsx)(a.aV,{sx:{m:2},children:(0,v.jsx)(h.Z,{dataLength:L.length,next:function(){console.log("load more message")},height:"500px",style:{display:"flex",flexDirection:"column-reverse",gap:"0.2rem",m:2},hasMore:!0,loader:(0,v.jsx)(x.Ex,{isIndeterminate:!0}),children:L.length<0?(0,v.jsx)(a.HC,{children:(0,v.jsx)(a.xv,{children:"Let\u2018s start chatting"})},"no-content"):L.map((function(e){return(0,v.jsx)(a.HC,{children:(0,v.jsx)(a.xu,{sx:{display:"flex",justifyContent:e.from===n.id?"end":"start"},children:(0,v.jsx)(a.xv,{sx:{width:"max-content",padding:".2rem .5rem",color:"blackAlpha.900",backgroundColor:"gray.300",borderRadius:"0.3rem"},children:e.content})})},"message_".concat(e.id))}))})}):(0,v.jsx)(a.xu,{component:"div",height:"500px",display:"flex",flexDirection:"column",justifyContent:"end",children:(0,v.jsx)(a.xv,{textAlign:"center",children:"Please choose a room"})}),(0,v.jsxs)(a.xu,{as:"form",sx:{display:"flex",gap:"0.2rem",m:2},onSubmit:function(e){e.preventDefault();var t=J.current,i=t.value.trim();if(""!==i){var s={content:i,room:D.id,from:n.id};G.send("/app/chat.sendMessage",{},JSON.stringify(s)),t.value=""}},children:[(0,v.jsx)(d.II,{sx:{flex:11},ref:J}),(0,v.jsx)(u.zx,{type:"submit",colorScheme:"messenger",children:(0,v.jsx)(m.G,{icon:c.XC})})]})]})}),(0,v.jsx)(a.xu,{sx:{display:"flex",flex:1,flexDirection:"column"},children:(0,v.jsx)(h.Z,{dataLength:t.length,next:function(){console.log("load more room")},height:"100%",style:{display:"flex",flexDirection:"column",gap:"0.2rem"},hasMore:!0,loader:(0,v.jsx)(x.Ex,{isIndeterminate:!0}),children:t.map((function(n){return(0,v.jsxs)(u.zx,{variant:"solid",colorScheme:D&&D.id===n.id?"teal":"gray",onClick:function(){e(S(n))},children:[(0,v.jsx)(m.G,{icon:r.FV}),"\xa0",n.name]},n.id)}))})})]})}}}]);
//# sourceMappingURL=2.0d7fe591.chunk.js.map